@addTagHelper *, Volo.Abp.AspNetCore.Mvc.UI.Bootstrap

@using Volo.CmsKit.Public.Web.Renderers
@using Volo.Abp.AspNetCore.Mvc.UI.Packages.HighlightJs
@using Volo.CmsKit.Public.Web.Pages.CmsKit.Shared.Components.Pages

@inject IMarkdownToHtmlRenderer MarkdownRenderer

@model Volo.CmsKit.Public.Web.Pages.CmsKit.Shared.Components.Pages.PageViewModel

<abp-card>
    <abp-card-body>
        @foreach (var contentFragment in Model.ContentFragments)
        {
            if (contentFragment is MarkdownContentFragment markdownContentFragment)
            {
                @Html.Raw(await MarkdownRenderer.RenderAsync(markdownContentFragment.Content))
            }
            else if (contentFragment is WidgetContentFragment widgetContentFragment)
            {
                //TODO
                if (widgetContentFragment.Name == "CmsPoll")
                {
                    @await Component.InvokeAsync(widgetContentFragment.Name, new
                        {
                            widgetName = "poll-right"
                        })
                }
                else
                {
                    @await Component.InvokeAsync(widgetContentFragment.Name,new
                        {
                            name = "poll-name"
                        })
                }
            }
        }
    </abp-card-body>
</abp-card>
